<!DOCTYPE html><html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи рждрзИрж░рж┐</title>
  <style>
    body {
      font-family: 'Noto Sans Bengali', sans-serif;
      background: #eef2f7;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 900px;
      margin: auto;
      padding: 20px;
      background: #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-top: 30px;
    }
    h2 {
      text-align: center;
      color: #333;
    }
    label {
      display: block;
      margin: 10px 0 5px;
    }
    input, textarea, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .flex-row {
      display: flex;
      gap: 10px;
    }
    .flex-row > div {
      flex: 1;
    }
    button {
      padding: 10px 20px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }
    .medicine-group {
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 10px;
      background: #f9f9f9;
    }
    #prescriptionDisplay {
      display: none;
      margin-top: 30px;
      padding: 20px;
      border: 2px dashed #007bff;
      background: #fff;
    }
    .section-title {
      margin-top: 20px;
      margin-bottom: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>
<div class="container">
  <h2>ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи рждрзИрж░рж┐ ржХрж░рзБржи</h2>
  <form id="prescriptionForm">
    <div class="section-title">ржЦрж╛ржорж╛рж░рж┐рж░ рждржерзНржп</div>
    <input type="text" placeholder="ржЦрж╛ржорж╛рж░рж┐ ржирж╛ржо" id="farmerName" required>
    <input type="text" placeholder="ржлрзЛржи ржиржорзНржмрж░" id="farmerPhone" required>
    <input type="text" placeholder="ржарж┐ржХрж╛ржирж╛" id="address">
    <input type="text" placeholder="ржЦрж╛ржорж╛рж░рж┐ ржзрж░ржи (ржкрзЛрж▓рзНржЯрзНрж░рж┐/ржбрзЗржЗрж░рж┐ ржЗрждрзНржпрж╛ржжрж┐)" id="farmerType"><div class="section-title">рж░рзЛржЧ рж╕ржВржХрзНрж░рж╛ржирзНржд рждржерзНржп</div>
<textarea placeholder="рж▓ржХрзНрж╖ржг" id="symptoms"></textarea>
<textarea placeholder="ржкрж░рзАржХрзНрж╖рж╛" id="tests"></textarea>
<textarea placeholder="рж░рзЛржЧ ржирж┐рж░рзНржгрзЯ" id="diagnosis"></textarea>

<div class="section-title">ржорзЗржбрж┐рж╕рж┐ржи</div>
<div id="medicineContainer"></div>
<button type="button" onclick="addMedicine()">тЮХ ржУрж╖рзБржз ржпрзБржХрзНржд ржХрж░рзБржи</button>

<div class="section-title">ржирзЛржЯ</div>
<textarea id="note" placeholder="ржирзЛржЯ"></textarea>

<button type="submit">тЬЕ ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи рждрзИрж░рж┐ ржХрж░рзБржи</button>

  </form>  <div id="prescriptionDisplay">
    <h3>ЁЯУД рждрзИрж░рж┐ рж╣ржУрзЯрж╛ ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи</h3>
    <div id="outputArea"></div>
    <button onclick="downloadPrescription()">тмЗя╕П ржкрж┐ржбрж┐ржПржл ржбрж╛ржЙржирж▓рзЛржб ржХрж░рзБржи</button>
  </div>
</div>
<script>
let prescriptionId = "";

function addMedicine() {
  const container = document.getElementById("medicineContainer");
  const div = document.createElement("div");
  div.className = "medicine-group";
  div.innerHTML = `
    <input type="text" placeholder="ржУрж╖рзБржзрзЗрж░ ржирж╛ржо" class="medName">
    <input type="text" placeholder="ржХржд ржмрж╛рж░" class="medDose">
    <input type="text" placeholder="ржХржЦржи" class="medTime">
    <input type="text" placeholder="ржХржд ржжрж┐ржи" class="medDays">
    <input type="text" placeholder="ржоржирзНрждржмрзНржп" class="medComment">
    <button type="button" onclick="this.parentNode.remove()">тЭМ ржорзБржЫрзБржи</button>
  `;
  container.appendChild(div);
}

function generatePrescriptionID() {
  const now = new Date();
  const y = now.getFullYear();
  const m = (now.getMonth()+1).toString().padStart(2, '0');
  const d = now.getDate().toString().padStart(2, '0');
  const rand = Math.floor(100000 + Math.random() * 900000); // 6 digit
  return `${y}${m}${d}${rand}`;
}

function downloadPrescription() {
  const content = document.getElementById('outputArea').innerText;
  const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "prescription_" + prescriptionId + ".txt";
  link.click();
}

// Form Submission
document.getElementById("prescriptionForm").addEventListener("submit", function(e){
  e.preventDefault();
  prescriptionId = generatePrescriptionID();

  const name = document.getElementById("farmerName").value;
  const phone = document.getElementById("farmerPhone").value;
  const address = document.getElementById("address").value;
  const type = document.getElementById("farmerType").value;
  const symptoms = document.getElementById("symptoms").value;
  const tests = document.getElementById("tests").value;
  const diagnosis = document.getElementById("diagnosis").value;
  const note = document.getElementById("note").value;

  let medicines = [];
  document.querySelectorAll('.medicine-group').forEach(group => {
    medicines.push({
      name: group.querySelector('.medName').value,
      dose: group.querySelector('.medDose').value,
      time: group.querySelector('.medTime').value,
      days: group.querySelector('.medDays').value,
      comment: group.querySelector('.medComment').value
    });
  });

  const prescription = {
    id: prescriptionId,
    name,
    phone,
    address,
    type,
    symptoms,
    tests,
    diagnosis,
    medicines,
    note,
    date: new Date().toLocaleString()
  };

  // Save to localStorage
  let data = JSON.parse(localStorage.getItem("prescriptions") || "[]");
  data.push(prescription);
  localStorage.setItem("prescriptions", JSON.stringify(data));

  // Show result
  let html = `
    <b>ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи ржЖржЗржбрж┐:</b> ${prescriptionId}<br>
    <b>ржирж╛ржо:</b> ${name} <br>
    <b>ржлрзЛржи:</b> ${phone} <br>
    <b>ржарж┐ржХрж╛ржирж╛:</b> ${address} (${type}) <br><br>
    <b>рж▓ржХрзНрж╖ржг:</b> ${symptoms} <br>
    <b>ржкрж░рзАржХрзНрж╖рж╛:</b> ${tests} <br>
    <b>рж░рзЛржЧ:</b> ${diagnosis} <br><br>
    <b>ржорзЗржбрж┐рж╕рж┐ржи:</b><br>
  `;
  prescription.medicines.forEach((med, i) => {
    html += `${i + 1}. ${med.name}, ${med.dose} ржмрж╛рж░, ${med.time}, ${med.days} ржжрж┐ржи, ржоржирзНрждржмрзНржп: ${med.comment}<br>`;
  });
  html += `<br><b>ржирзЛржЯ:</b> ${note}<br><br><i>ржбрж╛ржХрзНрждрж╛рж░: рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ ржирж╛ржо</i>`;

  document.getElementById("outputArea").innerHTML = html;
  document.getElementById("prescriptionDisplay").style.display = "block";
});
</script></body>
</html>